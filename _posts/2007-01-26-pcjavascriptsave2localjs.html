---
layout: post
permalink: /2007/01/26/pcjavascriptsave2localjs.html
title: "ローカルPCへ大容量データを保存するJavaScriptライブラリ「save2local.js」"
date: 2007-01-26T00:18:09.00+09:00
tags:
  - "Sakatoku"
categories:
  - "Tips"
---
こんにちは。さかとくです。<br/>
JavaScriptでローカルPCにデータを保存するライブラリ「save2local.js」を作りましたので公開します。<br/>
通常、JavaScriptではセキュリティが考慮されているため、データをローカルPCに保存するには、Cookieを利用します。<br/>
しかし、Cookieを利用する場合は、それほどたくさんの情報を保存することができません。<br/>
そのため、ゲームのセーブデータや、フォームに記入したデータなどは、セッションの仕組みを利用してサーバーに保存するのが一般的でした。「save2local.js」ライブラリを使えば、サーバーを利用することなく、ローカルPCに任意のテキストを保存できます。<br/>
<br/>
今回ローカルPCにデータを保存するために、Flashの機能を使います。Flashには、SharedObjectと言ってローカルPCにデータを保存する機能がついています。このライブラリでも、この機能を利用してローカルへのデータ保存を実現しています。<br/>
<br/>
以前、ウノウラボでFlashとJavaScriptを組み合わせて、<a href="http://labs.unoh.net/2006/12/javascriptiefirefox.html">クリップボードへ保存するライブラリ</a>や、<a href="http://labs.unoh.net/2006/11/javascriptmp3.html">MP3を再生するライブラリ</a>を作りました。<br/>
今回も、これとほとんど同じ要領でFlashを利用するライブラリを作った訳ですが、
Flashと併用することで、JavaScriptの可能性を何倍にも広げることができると思います。<br/>
<br/><br/>

<h3>ライブラリのダウンロード</h3>
<a href="/files/save2local_js.zip">→「save2local.js」ライブラリをダウンロード</a>

<h3>サンプル</h3>

<a href="http://labs.unoh.net/test_save2local_js.html">→「save2local.jsのテストページ」</a>


<h3>使い方</h3>
ライブラリの使い方は至って簡単です。<br/>
<br/>
(1)&nbsp;ライブラリをダウンロードしたら、アーカイブ内の以下のファイルをHTMLと同じフォルダか参照できるところにコピーします。<br/>
<br/>
-swfobject.js<br/>
-save2local.swf<br/>
-save2local.js<br/>
<br/>
(2)&nbsp;以下のコードをHTMLに貼り付けます。<br/>
<br/>
---&nbsp;ここから&nbsp;---<br/>
&lt;!--&nbsp;save2local.setup.begin&nbsp;--&gt;<br/>
&lt;script&nbsp;type=&quot;text/javascript&quot;&nbsp;src=&quot;swfobject.js&quot;&gt;&lt;/script&gt;<br/>
&lt;script&nbsp;type=&quot;text/javascript&quot;&nbsp;src=&quot;save2local.js&quot;&gt;&lt;/script&gt;<br/>
&lt;!--&nbsp;save2local.setup.end&nbsp;--&gt;<br/>
---&nbsp;ここまで&nbsp;---<br/>
<br/>
(3)&nbsp;リンクをクリックしたらセーブ＆ロードする場合には以下のように記述します。<br/>
<br/>
---&nbsp;ここから&nbsp;---<br/>
&lt;script&nbsp;type=&quot;text/javascript&quot;&gt;&lt;!--<br/>
function&nbsp;test()&nbsp;{<br/>
&nbsp;&nbsp;save2local.saveData(&quot;key&quot;,&quot;value&quot;);<br/>
&nbsp;&nbsp;alert(&nbsp;save2local.loadData(&quot;key&quot;)&nbsp;);<br/>
}<br/>
--&gt;&lt;/script&gt;<br/>
&lt;a&nbsp;href=&quot;javascript:test()&quot;&gt;test&lt;/a&gt;<br/>
---&nbsp;ここまで&nbsp;---<br/>
<br/>
以上です。<br/>
<br/>
保存する時には、「save2local.saveData(key,&nbsp;data)」と書きます。keyには任意の文字列を指定できます。<br/>
そして、読み込みたい時は「save2local.loadData(key)」のように書きます。<br/>
<br/>
キーとデータの組で保存できますので、簡単なデータベースとしても利用できると思います。<br/>
<br/>
発展的な使い方としては、はてなダイアリーの日記記入フォームのように、入力中のテキストを定期的に保存するようにすれば、<br/>
万が一、長いテキストの入力中にブラウザが落ちたり、ページが切り替わってしまった場合にも、以前の状態に戻すことができるでしょう。<br/>
<br/>
また、ユーザーの設定によって、数メガのデータを保存することができます。<br/>
郵便番号データベースや、ゲームのセーブデータなど、一時的なデータの保存に活躍できると思います。<br/>
<br/>
ぜひ、使ってみてください。
