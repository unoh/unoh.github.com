---
layout: post
title: "<?php を閉じてみる"
---
<p>こんにちは、7月からphpを始めた細川です。</p>

<p>phpの作法で&lt;?phpではじめたファイルを?&gt;で閉じない、というものがあります。これまで、あまり考えずに従ってきたのですが、よく考えてみると「タグを閉じない」というのは直感的には不作法です。</p>

<p>検索して調べてみると、以下のような記事が見つかりました。</p>

<p><a href="http://zendframework.com/manual/ja/coding-standard.php-file-formatting.html#coding-standard.php-file-formatting.general">http://zendframework.com</a> より引用<br />
</p><blockquote><br />
<b><span class="caps">PHP </span>コードのみからなるファイルでは、終了タグ ("?&gt;") は決して含めてはいけません。これは必須なものではなく、 終了タグを省略することで、ファイルの最後にある空白文字が出力に影響することを防ぎます。</b><br /><br />
</blockquote><p></p>

<p>「決して」含めてはいけない。ということで、わりと大事のようです。<br />そこで、実際にタグを閉じると何がおこりうるのか調べてみることにしました。<br /><br /></p><p>まず、以下のようなphpファイルtest.phpを用意しました。</p><code><div><code><b><div>&lt;html&gt;&lt;body&gt;&lt;?php</div><div>echo 'おはようございます';</div><div>?&gt;&lt;/body&gt;&lt;/html&gt;</div></b></code></div><div><code><br /></code></div><div><span class="Apple-style-span" style="font-family: arial, helvetica, hirakakupro-w3, osaka, 'ms pgothic', sans-serif; ">出力結果は以下のようになります。</span></div><div><span class="Apple-style-span" style="font-family: arial, helvetica, hirakakupro-w3, osaka, 'ms pgothic', sans-serif; "><br /></span></div><div><b><span class="Apple-style-span" style="font-family: arial, helvetica, hirakakupro-w3, osaka, 'ms pgothic', sans-serif; "></span><span class="Apple-style-span" style="font-family: arial, helvetica, hirakakupro-w3, osaka, 'ms pgothic', sans-serif; ">&lt;html&gt;&lt;body&gt;おはようございます&lt;/body&gt;&lt;/html&gt;</span></b></div><div><span class="Apple-style-span" style="font-family: arial, helvetica, hirakakupro-w3, osaka, 'ms pgothic', sans-serif; "><br /></span></div><div><span class="Apple-style-span" style="font-family: arial, helvetica, hirakakupro-w3, osaka, 'ms pgothic', sans-serif; "></span><span class="Apple-style-span" style="font-family: arial, helvetica, hirakakupro-w3, osaka, 'ms pgothic', sans-serif; ">次に、別のphpファイルfunctions.phpを用意し、それをrequireで読み込んでみます。</span></div><div><span class="Apple-style-span" style="font-family: arial, helvetica, hirakakupro-w3, osaka, 'ms pgothic', sans-serif; "><br /></span></div><div><div><font class="Apple-style-span" face="arial, helvetica, hirakakupro-w3, osaka, 'ms pgothic', sans-serif"><b>&lt;?php</b></font></div><div><font class="Apple-style-span" face="arial, helvetica, hirakakupro-w3, osaka, 'ms pgothic', sans-serif"><b><br /></b></font></div><div><font class="Apple-style-span" face="arial, helvetica, hirakakupro-w3, osaka, 'ms pgothic', sans-serif"><b>function hoge()</b></font></div><div><font class="Apple-style-span" face="arial, helvetica, hirakakupro-w3, osaka, 'ms pgothic', sans-serif"><b>{</b></font></div><div><font class="Apple-style-span" face="arial, helvetica, hirakakupro-w3, osaka, 'ms pgothic', sans-serif"><b>}</b></font></div><div><font class="Apple-style-span" face="arial, helvetica, hirakakupro-w3, osaka, 'ms pgothic', sans-serif"><b><br /></b></font></div><div><font class="Apple-style-span" face="arial, helvetica, hirakakupro-w3, osaka, 'ms pgothic', sans-serif"><b>?&gt;</b></font></div></div><div><font class="Apple-style-span" face="arial, helvetica, hirakakupro-w3, osaka, 'ms pgothic', sans-serif"><br /></font></div><div><font class="Apple-style-span" face="arial, helvetica, hirakakupro-w3, osaka, 'ms pgothic', sans-serif"><div>functions.phpファイルは?&gt;で閉じていますが、ファイル末尾にはなにもありません。</div><div><br /></div><div>test.phpを以下のように変更します。</div></font></div><div><font class="Apple-style-span" face="arial, helvetica, hirakakupro-w3, osaka, 'ms pgothic', sans-serif"><br /></font></div><div><font class="Apple-style-span" face="arial, helvetica, hirakakupro-w3, osaka, 'ms pgothic', sans-serif"><div><b>&lt;html&gt;&lt;body&gt;&lt;?php</b></div><div><b>require('functions.php');</b></div><div><b>echo 'おはようございます';</b></div><div><b>?&gt;&lt;/body&gt;&lt;/html&gt;</b></div><div><br /></div><div><br /></div><div>この場合、出力結果は、以下のようになります。</div><div><br /></div><div><b>&lt;html&gt;&lt;body&gt;おはようございます&lt;/body&gt;&lt;/html&gt;</b></div><div><br /></div><div>この場合には何も余分なものはつかないようです。</div><div><br /></div><div>次に、閉じタグの後ろに改行をいれてみました。</div><div>その場合の出力結果が以下です。</div><div><br /></div><div><b>&lt;html&gt;&lt;body&gt;おはようございます&lt;/body&gt;&lt;/html&gt;</b></div><div><br /></div><div>改行だけでは問題ないようです。</div><div><br /></div><div>改行を２つ入れてみました。</div><div><br /></div><div><div><b>&lt;html&gt;&lt;body&gt;</b></div><div><b>おはようございます&lt;/body&gt;&lt;/html&gt;</b></div><div><br /></div><div>改行が１つ挿入されました。</div><div><br /></div><div>閉じタグの後ろに4つスペースをいれます。</div></div><div><br /></div><div><div><b>&lt;html&gt;&lt;body&gt; &nbsp; &nbsp;おはようございます&lt;/body&gt;&lt;/html&gt;</b></div></div><div><br /></div><div>スペースが挿入されました。</div><div><br /></div><div>最後に閉じタグ無しで末尾に4つスペースをつけた場合です。</div><div><br /></div><div><b>&lt;html&gt;&lt;body&gt;おはようございます&lt;/body&gt;&lt;/html&gt;</b></div><div><br /></div><div>当然といえば当然ですが、大丈夫ですね。</div><div><br /></div><div>閉じタグ以降に改行だと2つ以上から、スペースだと1つ以上あると、出力に影響するようです。</div><div><br /></div><div>必ずしも閉じタグをつけたからといって出力に影響が出るとは限らないようですが、事故防止のためには閉じない方が良さそうですね!</div></font></div></code>
<br />
